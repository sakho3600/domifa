image:
  repository: ${CI_REGISTRY_IMAGE}/backend
  tag: ${IMAGE_TAG}

deployment:
  port: 3000

  # resources:
  #   limits:
  #     cpu: 1000m
  #     memory: 320Mi # 256 + 64~(20% of 256)
  #   requests:
  #     cpu: 500m
  #     memory: 128Mi

  livenessProbe:
    path: /health
    failureThreshold: 2
    initialDelaySeconds: 10
    periodSeconds: 2
    successThreshold: 1
    timeoutSeconds: 3
  readinessProbe:
    path: /health
    failureThreshold: 2
    initialDelaySeconds: 10
    periodSeconds: 2
    successThreshold: 1
    timeoutSeconds: 3

  env:
    - name: NODE_ENV
      value: "production"
    - name: VERSION
      value: "${VERSION}"

service:
  port: 3000
  targetPort: 3000

ingress:
  enabled: true
  annotations:
    appgw.ingress.kubernetes.io/ssl-redirect: "true"
    kubernetes.io/ingress.class: "azure/application-gateway"
  hosts:
    - host: ${HOST}
      paths:
        - path: /
          servicePort: 3000
  tls:
    - hosts:
        - "${HOST}"
      secretName: wildcard-crt
